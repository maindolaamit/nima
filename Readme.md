# Image Quality Assessment

Project to implement Neural Image Quality Assessment using Deep Learning CNN based on Google's research paper "NIMA :
Neural Image Assessment"

NIMA consists of two models that aim to predict the aesthetic and technical quality of images, respectively. The models
are trained via transfer learning, where ImageNet pre-trained CNNs are used and fine-tuned for the classification task.

The provided code allows the use any of pre-trained models in Keras. The models trained on AVA images for local CPU.



### **Download AVA Dataset**

The AVA data set has below structure, images folder will host the all the required images. 

<img src=".\project-snaps\ava-dataset-structure.jpg" alt="ava-dataset-structure" style="zoom:100%;" />

Information about the dataset is stored in the file AVA.txt, for faster reading use Modin[dask] Pandas.

Two utilities script have been created to facilitate various work around the AVA dataset. 

1. **ava_preprocess.py**

   This script hosts multiple methods to preprocess and filter the information about the images actually present in the dataset, the file is present in the ```nima\utils\ava_preprocess.py```. Below are some of the notable activities and their respective methods.

   - **make_ava_csv** : To test on some sample images we can keep only few images in the images folder and can create a new file AVA.csv, this file will list only those records from AVA.txt against which images are actually present in the dataset. We can easily create/update the file by calling ```make_ava_csv``` method 

   - **get_original_ava_df** : To the get Pandas DataFrame on Original file AVA.txt `get_original_ava_df` method can be called

   - **get_csv_df_with_max_rating** : To get the ava.csv DataFrame with max rating count field. 

   - **get_tags_df** : To get the Pandas DataFrame on tags.txt.

     

2. **ava_archive.py**

   This script will create multiple zip files out of the images present in `images` folder of the Dataset. The zip file will be named based on batch number and will have only images belonging to that particular batch. The Batch numbers are generated by dividing image_id by 10000. For e.g. image_id 12001 will have batch_id 2. 

3. **ava_downloader.py**

   To download the images into the local system we can execute the ``nima\utils\ava_downloader.py`` by passing the AVA Dataset project as parameter, for e.g.. below command will download the images into the folder  E:\AVA_dataset\images.

   ```python nima/utils/ava_downloader.py -d E:\AVA_dataset```

   > Note : Image hosting server will block the download after sometime stating "*malicious activity detected*"

   

### Train Model on AVA Dataset

To train model on the AVA dataset run the `train.py` file present in `nima/train.py`

